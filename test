-- Ne0e's Enhanced Library V2

local Library = {}

-- Services
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

-- Constants
local TWEEN_INFO = TweenInfo.new(0.3, Enum.EasingStyle.Quart)
local CORNER_RADIUS = UDim.new(0, 6)

-- Create Intro Animation
local function CreateIntro()
    local IntroGui = Instance.new("ScreenGui")
    IntroGui.Name = "Ne0eIntro"
    IntroGui.Parent = CoreGui
    
    local Background = Instance.new("Frame")
    Background.Size = UDim2.new(1, 0, 1, 0)
    Background.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    Background.BackgroundTransparency = 1
    Background.Parent = IntroGui
    
    local LogoFrame = Instance.new("Frame")
    LogoFrame.Size = UDim2.new(0, 100, 0, 100)
    LogoFrame.Position = UDim2.new(0.5, -50, 0.5, -50)
    LogoFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    LogoFrame.BackgroundTransparency = 1
    LogoFrame.Parent = Background
    Instance.new("UICorner", LogoFrame).CornerRadius = UDim.new(0, 20)
    
    local LogoText = Instance.new("TextLabel")
    LogoText.Size = UDim2.new(1, 0, 1, 0)
    LogoText.BackgroundTransparency = 1
    LogoText.Text = "N"
    LogoText.TextColor3 = Color3.fromRGB(255, 255, 255)
    LogoText.TextSize = 60
    LogoText.Font = Enum.Font.GothamBold
    LogoText.TextTransparency = 1
    LogoText.Parent = LogoFrame
    
    local LoadingText = Instance.new("TextLabel")
    LoadingText.Size = UDim2.new(0, 200, 0, 30)
    LoadingText.Position = UDim2.new(0.5, -100, 0.5, 60)
    LoadingText.BackgroundTransparency = 1
    LoadingText.Text = "Ne0e Library"
    LoadingText.TextColor3 = Color3.fromRGB(255, 255, 255)
    LoadingText.TextSize = 18
    LoadingText.Font = Enum.Font.GothamSemibold
    LoadingText.TextTransparency = 1
    LoadingText.Parent = Background
    
    -- Animate Intro
    TweenService:Create(Background, TweenInfo.new(0.5), {BackgroundTransparency = 0}):Play()
    wait(0.5)
    TweenService:Create(LogoFrame, TweenInfo.new(0.5), {BackgroundTransparency = 0}):Play()
    TweenService:Create(LogoText, TweenInfo.new(0.5), {TextTransparency = 0}):Play()
    wait(0.3)
    TweenService:Create(LoadingText, TweenInfo.new(0.5), {TextTransparency = 0}):Play()
    wait(1.5)
    
    -- Fade Out
    TweenService:Create(Background, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    TweenService:Create(LogoFrame, TweenInfo.new(0.5), {BackgroundTransparency = 1}):Play()
    TweenService:Create(LogoText, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
    TweenService:Create(LoadingText, TweenInfo.new(0.5), {TextTransparency = 1}):Play()
    wait(0.5)
    IntroGui:Destroy()
end

function Library:CreateWindow(title)
    -- Play Intro
    CreateIntro()
    wait(0.5) -- Wait for intro to finish
    
    -- Create Main GUI
    local NeoeLibrary = Instance.new("ScreenGui")
    NeoeLibrary.Name = "NeoeLibrary"
    NeoeLibrary.Parent = CoreGui
    
    -- Main Window Frame
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 550, 0, 350)
    MainFrame.Position = UDim2.new(0.5, -275, 0.5, -175)
    MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    MainFrame.BorderSizePixel = 0
    MainFrame.ClipsDescendants = true
    MainFrame.Parent = NeoeLibrary
    Instance.new("UICorner", MainFrame).CornerRadius = CORNER_RADIUS
    
    -- Title Bar
    local TitleBar = Instance.new("Frame")
    TitleBar.Name = "TitleBar"
    TitleBar.Size = UDim2.new(1, 0, 0, 30)
    TitleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    TitleBar.BorderSizePixel = 0
    TitleBar.Parent = MainFrame
    Instance.new("UICorner", TitleBar).CornerRadius = CORNER_RADIUS
    
    -- Make window draggable
    local dragging = false
    local dragStart = nil
    local startPos = nil
    
    TitleBar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = MainFrame.Position
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            MainFrame.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    -- Title Text
    local TitleText = Instance.new("TextLabel")
    TitleText.Size = UDim2.new(1, -100, 1, 0)
    TitleText.Position = UDim2.new(0, 10, 0, 0)
    TitleText.BackgroundTransparency = 1
    TitleText.Text = title or "Ne0e Library"
    TitleText.TextColor3 = Color3.fromRGB(255, 255, 255)
    TitleText.TextSize = 14
    TitleText.Font = Enum.Font.GothamBold
    TitleText.TextXAlignment = Enum.TextXAlignment.Left
    TitleText.Parent = TitleBar
    
    -- Close Button
    local CloseButton = Instance.new("TextButton")
    CloseButton.Size = UDim2.new(0, 24, 0, 24)
    CloseButton.Position = UDim2.new(1, -27, 0, 3)
    CloseButton.BackgroundColor3 = Color3.fromRGB(255, 70, 70)
    CloseButton.Text = "Ã—"
    CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    CloseButton.TextSize = 16
    CloseButton.Font = Enum.Font.GothamBold
    CloseButton.Parent = TitleBar
    Instance.new("UICorner", CloseButton).CornerRadius = UDim.new(0, 4)
    
    -- Minimize Button
    local MinimizeButton = Instance.new("TextButton")
    MinimizeButton.Size = UDim2.new(0, 24, 0, 24)
    MinimizeButton.Position = UDim2.new(1, -54, 0, 3)
    MinimizeButton.BackgroundColor3 = Color3.fromRGB(255, 180, 50)
    MinimizeButton.Text = "-"
    MinimizeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    MinimizeButton.TextSize = 16
    MinimizeButton.Font = Enum.Font.GothamBold
    MinimizeButton.Parent = TitleBar
    Instance.new("UICorner", MinimizeButton).CornerRadius = UDim.new(0, 4)

    -- Tabs Scrolling Frame
    local TabsScrollFrame = Instance.new("ScrollingFrame")
    TabsScrollFrame.Name = "TabsScrollFrame"
    TabsScrollFrame.Size = UDim2.new(0, 130, 1, -35)
    TabsScrollFrame.Position = UDim2.new(0, 5, 0, 35)
    TabsScrollFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    TabsScrollFrame.BorderSizePixel = 0
    TabsScrollFrame.ScrollBarThickness = 2
    TabsScrollFrame.ScrollBarImageColor3 = Color3.fromRGB(55, 55, 55)
    TabsScrollFrame.Parent = MainFrame
    Instance.new("UICorner", TabsScrollFrame).CornerRadius = CORNER_RADIUS

    local TabList = Instance.new("UIListLayout")
    TabList.SortOrder = Enum.SortOrder.LayoutOrder
    TabList.Padding = UDim.new(0, 5)
    TabList.Parent = TabsScrollFrame

    local TabPadding = Instance.new("UIPadding")
    TabPadding.PaddingTop = UDim.new(0, 5)
    TabPadding.PaddingLeft = UDim.new(0, 5)
    TabPadding.PaddingRight = UDim.new(0, 5)
    TabPadding.Parent = TabsScrollFrame

    -- Content Container
    local ContentContainer = Instance.new("Frame")
    ContentContainer.Name = "ContentContainer"
    ContentContainer.Size = UDim2.new(1, -145, 1, -35)
    ContentContainer.Position = UDim2.new(0, 140, 0, 35)
    ContentContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    ContentContainer.BorderSizePixel = 0
    ContentContainer.Parent = MainFrame
    Instance.new("UICorner", ContentContainer).CornerRadius = CORNER_RADIUS

    -- Window State
    local minimized = false
    local originalSize = MainFrame.Size

    -- Minimize/Close Functions
    MinimizeButton.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            MainFrame:TweenSize(UDim2.new(0, 550, 0, 30), "Out", "Quad", 0.3, true)
        else
            MainFrame:TweenSize(originalSize, "Out", "Quad", 0.3, true)
        end
    end)

    CloseButton.MouseButton1Click:Connect(function()
        NeoeLibrary:Destroy()
    end)

    -- Update ScrollingFrame canvas size when tabs are added
    TabList:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        TabsScrollFrame.CanvasSize = UDim2.new(0, 0, 0, TabList.AbsoluteContentSize.Y + 10)
    end)

    local Window = {}
    
    -- Rest of your existing Window functions (CreateTab, etc.)
    -- ... (Keep your existing Tab creation and element functions)

    return Window
end

return Library
